function intColumn(n){var t=n.min||0,i=n.max||10;return $.extend(!0,{width:200,format:"{0:n0}",editor:function(n,r){$('<input name="'+r.field+'" data-bind="value:'+r.field+'"/>').appendTo(n).kendoNumericTextBox({format:"{0:n0}",min:t,max:i})}},n)}function floatColumn(n){return $.extend(!0,{width:200,format:"{0:0.00}",editor:function(n,t){$('<input name="'+t.field+'" data-bind="value:'+t.field+'"/>').appendTo(n).kendoNumericTextBox({decimals:2,spinners:!1})}},n)}function doubleColumn(n){var t=n.min||null,i=n.max||null;return $.extend(!0,{width:200,format:"{0:n6}",editor:function(n,r){$('<input name="'+r.field+'" data-bind="value:'+r.field+'"/>').appendTo(n).kendoNumericTextBox({decimals:6,format:"n6",min:t,max:i,spinners:!1})}},n)}function textareaEditor(n,t){$('<textarea name="'+t.field+'" data-bind="value:'+t.field+'" class="k-input k-textbox" rows="5" style="width: 100%"/>').appendTo(n)}function descriptionColumn(n){var t=n&&n.field||"Description";return $.extend(!0,{field:t,title:"描述",width:300,editor:textareaEditor,template:function(n){var i=n[t];return i?kendo.format("<pre class='k-content'>{0}<\/pre>",i):""}},n)}function dateColumn(n){return $.extend(!0,{format:"{0: yyyy-MM-dd}",width:200,editor:function(n,t){$('<input name="'+t.field+'" data-bind="value:'+t.field+'"/>').appendTo(n).kendoTimePicker({format:"yyyy-MM-dd",parseFormats:["yyyy-MM-dd"]})}},n)}function timeColumn(n){return $.extend(!0,{format:"{0: HH:mm}",width:200,editor:function(n,t){$('<input name="'+t.field+'" data-bind="value:'+t.field+'"/>').appendTo(n).kendoTimePicker({format:"HH:mm",parseFormats:["HH:mm"]})}},n)}function datetimeColumn(n){return $.extend(!0,{format:"{0: yyyy-MM-dd HH:mm}",width:200,editor:function(n,t){$('<input name="'+t.field+'" data-bind="value:'+t.field+'"/>').appendTo(n).kendoDateTimePicker({format:"yyyy-MM-dd HH:mm",parseFormats:["yyyy-MM-dd HH:mm"]})}},n)}(function(n,t){t(["./kendo.grid"],n)})(function(){return function(n,t){var i=window.kendo,u=i.ui,r=i.ui.Grid,l=n.extend,s=n.proxy,o="k-state-disabled",f=".kendoGrid",e="click",h=["kendoComboBox","kendoDatePicker","kendoDateTimePicker","kendoDropDownList","kendoMaskedTextBox","kendoNumericTextBox","kendoMultiSelect"],c;l(u,{enable:function(i,r){r=r===t?!0:r;n(h).each(function(){if(i.data()[this]){i.data()[this].enable(r);return}});i.attr("disabled",!r)},readonly:function(i,r){r=r===t?!0:r;n(h).each(function(){if(i.data()[this]){i.data()[this].readonly(r);return}});i.attr("readonly",r)}},!0);c=r.extend({init:function(t,i){var u=this;n(i.columns).each(function(){var t=this,e=t.foreign,r=i.filterable,f;e&&(f=e.mode||"key",f=="key"?(n.extend(!0,t,u._createForeignKeyColumn(t)),r&&r.mode=="row"&&(i.autoBind=!1)):f=="value"?(n.extend(!0,t,u._createForeignValueColumn(t)),r&&r.mode=="row"&&(i.autoBind=!1)):f=="collection"&&n.extend(!0,t,u._createForeignCollectionColumn(t)))});typeof i.toolbar=="undefined"&&(i.toolbar=["title","separator","create","edit","destroy","update","canceledit"]);i.name="Grid";r.fn.init.call(u,t,i)},options:{name:"EditableGrid",scrollable:!1,sortable:!0,filterable:!0,selectable:!0,pageable:{refresh:!0,pageSizes:!0},editable:"popup",dataBound:function(){this._enableToolbar(this.select().length>0)},change:function(){this._enableToolbar(this.select().length>0)},edit:function(t){var i=this;t.model.isNew()||n('[name="Id"]').attr("readonly",!0);n(i.options.columns).each(function(){this.disabled&&u.enable(n('[name="'+this.field+'"]'),!1);this.readonly&&u.readonly(n('[name="'+this.field+'"]'))})},save:function(t){var u=this,i=t.model,r=i.isNew();n(u.options.columns).each(function(n,u){var f=u.field,c,s;if(u.foreign){var f=this.field,e=u.foreign,o=e.mode||"key",h=e.dataValueField||"Id";o=="key"?(c=e.entity||f.replace("Id",""),r&&!i[f]&&(s=t.container.find("input[name="+f+"]").data("kendoDropDownList").dataItem(),i[f]=s&&s[h]||null)):o=="entity"?(r&&!i[f]&&(i[f]=t.container.find("input[name="+f+"]").data("kendoDropDownList").dataItem()),i[f+"Id"]=i[f]?i[f].Id:null):o=="collection"}})}},_toolbar:function(){var t=this,h=t.options.toolbar,u=t.options.editable,i;if(r.fn._toolbar.call(t),h&&(i=t.wrapper.find(".k-grid-toolbar"),u&&u.create!==!1)){i.on(e+f,".k-grid-edit",function(){t.editRow(t.select())}).on(e+f,".k-grid-delete",function(i){n(i.target).hasClass(o)||t.removeRow(t.select())});i.find(".k-grid-update").hide();i.find(".k-grid-cancel").hide();this._editCancelClickHandler||(this._editCancelClickHandler=s(this._editCancelClick,this));i.on(e+f,"a.k-grid-cancel",this._editCancelClickHandler);this._editUpdateClickHandler||(this._editUpdateClickHandler=s(this._editUpdateClick,this));i.on(e+f,"a.k-grid-update",this._editUpdateClickHandler)}},_createButton:function(n){var t=this,i;return n=="title"?(i=t.options.title||"","<span class='k-title k-widget k-state-selected'>"+i+"<\/span>"):n=="separator"?"<span class='k-separator'><\/span>":r.fn._createButton.call(t,n)},_createInlineEditor:function(n,t){var u=this,f=u.options.toolbar,i;r.fn._createInlineEditor.call(u,n,t);f&&(i=u.wrapper.find(".k-grid-toolbar"),i.find(".k-grid-edit").hide(),i.find(".k-grid-delete").hide(),i.find(".k-grid-update").show(),i.find(".k-grid-cancel").show())},_destroyEditView:function(){var t=this,i=t.options.toolbar,n;r.fn._destroyEditView.call(t);i&&(n=t.wrapper.find(".k-grid-toolbar"),n.find(".k-grid-update").hide(),n.find(".k-grid-cancel").hide(),n.find(".k-grid-edit").show(),n.find(".k-grid-delete").show())},_enableToolbar:function(n,t){var r=this,u=r.options.toolbar,t=t||".k-grid-edit,.k-grid-delete",i;u&&(i=r.wrapper.find(".k-grid-toolbar"),typeof n=="undefined"&&(n=!0),n?i.find(t).removeClass(o):i.find(t).addClass(o))},_createForeignKeyColumn:function(t){function e(t,i,u){return u=n.extend(!0,{field:i.field,entity:r.entity,dataTextField:r.dataTextField,dataValueField:r.dataValueField,template:r.template,url:r.url,expand:r.expand},u),t.kendoEditableDropDownList(u)}var f=t.field,r=t.foreign,o=t.editorInit,u=r.entity||f.replace("Id",""),h=r.required&&"required"||"",c=r.dataTextField||"Name",s=r.dataValueField||"Id";return n.extend(!0,{width:200,editor:function(c,l){var a=l.model,p=n('<input name="'+f+'" data-bind="value:'+f+'" '+h+"/>").appendTo(c),w=r.filterOperator||"startswith",v=r.filter||[],y;typeof v=="function"&&(v=v(a));y=e(p,t,{filter:w,dataSource:{filter:v},dataBound:function(){var t=this,n;a.isNew()&&(u!=f&&(n=t.dataItem(),a[u]=n&&n[s]?n:null),t.trigger("change"))}}).data("kendoDropDownList");u!=f&&n.extend(!0,y,{_change:function(){var t=this,n=t.dataItem();a[u]=n&&n[s]?n:null;i.ui.DropDownList.fn._change.call(t)}});typeof o=="function"&&o(c,l)},template:u!=f?i.format("#=typeof({0}) != 'undefined' && {0} ? {0}.{1} : ''#",u,c):i.format("#=typeof({0}) != 'undefined' && {0} ? {0} : ''#",u),filterable:{ui:function(n){e(n,t)},cell:{template:function(n){e(n.element,t,{dataBound:function(){this.trigger("change")}})},showOperators:!1}}},t)},_createForeignValueColumn:function(t){function e(t,i,u){return u=n.extend(!0,{field:i.field,entity:r.entity,dataTextField:r.dataTextField,dataValueField:r.dataValueField,template:r.template,url:r.url,expand:r.expand},u),t.kendoEditableComboBox(u)}var f=t.field,r=t.foreign,o=t.editorInit,u=r.entity||f.replace("Id",""),h=r.required&&"required"||"",c=r.dataTextField||"Name",s=r.dataValueField||"Id";return n.extend(!0,{width:200,editor:function(c,l){var a=l.model,p=n('<input name="'+f+'" data-bind="value:'+f+'" '+h+"/>").appendTo(c),w=r.filterOperator||"startswith",v=r.filter||[],y;typeof v=="function"&&(v=v(a));y=e(p,t,{filter:w,dataSource:{filter:v},dataBound:function(){var t=this,n;a.isNew()&&(u!=f&&(n=t.dataItem(),a[u]=n&&n[s]?n:null),t.trigger("change"))}}).data("kendoComboBox");u!=f&&n.extend(!0,y,{_change:function(){var t=this,n=t.dataItem();a[u]=n&&n[s]?n:null;i.ui.ComboBox.fn._change.call(t)}});typeof o=="function"&&o(c,l)},template:u!=f?i.format("#=typeof({0}) != 'undefined' && {0} ? {0}.{1} : ''#",u,c):i.format("#=typeof({0}) != 'undefined' && {0} ? {0} : ''#",u),filterable:{ui:function(n){e(n,t)},cell:{template:function(n){e(n.element,t,{dataBound:function(){this.trigger("change")}})},showOperators:!1}}},t)},_createForeignCollectionColumn:function(t){function l(t){var r=t.parent().parent().data("kendoFilterCell"),f=r.viewModel;n.extend(!0,r,{_merge:function(t){var f=this,s=t.logic||"and",o=t.filters,r,c=f.dataSource.filter()||{filters:[],logic:"and"};return o.length&&(r=o[0],r.value.length?r.expression=n.map(r.value,function(n){return i.format("{0}/{1}({2}:{2}/{3} eq '{4}')",u,"any",h,e,n[e])}).join(" "+s+" "):t.filters=[]),i.ui.FilterCell.fn._merge.call(f,t)},_parse:function(n){return n||""}})}function o(t,u,o){var c=r.placeholder||i.format("选择{0}…",u.title),s=r.template||i.format("#={0} ? {1} : '<空>'#",e,f),l=r.valueTemplate||s,a=r.url||"/odata/"+h,v=r.expand||i.format("?$select={0},{1}",e,f);return o=n.extend(!0,{filter:"startswith",placeholder:c,dataTextField:f,dataValueField:e,dataSource:{type:"odata-v4",serverFiltering:!0,serverSorting:!0,transport:{read:a+v},sort:{field:f}},template:s,valueTemplate:l},o),t.kendoMultiSelect(o)}var u=t.field,c=t.templatePre||!1,r=t.foreign,s=t.editorInit,h=r.entity||u.replace(/(\s+)?.$/,""),f=r.dataTextField||"Name",e=r.dataValueField||"Id";return n.extend(!0,{width:200,editor:function(i,f){var h=f.model,c=n('<input name="'+u+'" data-bind="value:'+u+'"/>').appendTo(i),l=r.filterOperator||"startswith",e=r.filter||[];typeof e=="function"&&(e=e(h));o(c,t,{autoClose:!1,filter:l,dataSource:{filter:e}});typeof s=="function"&&s(i,f)},template:function(t){var i=t[u]?n.map(t[u],function(n){return n[f]}).join(" | "):"";return c&&(i='<pre class="k-content list-wrapper">'+i+"<\/pre>"),i},filterable:{ui:function(n){o(n,t)},cell:{operator:"any",template:function(n){l(n.element);o(n.element,t)},showOperators:!1}}},t)}});u.plugin(c)}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()});